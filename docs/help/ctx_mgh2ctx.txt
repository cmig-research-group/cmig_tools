 Updated to handle n-d volumes
